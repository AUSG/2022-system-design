# ì•Œë¦¼ ì‹œìŠ¤í…œ

### ì•Œë¦¼ ìœ í˜•

![Untitled](images/notification_type.png)

### APNS

iOSì˜ ì•Œë¦¼ ì„œë¹„ìŠ¤ë¡œ device tokenê³¼ payloadë¥¼ ì •ë³´ë¡œ ë³´ë‚¸ë‹¤.

```json
// Payload
{
  "apps": {
    "alert": {
      "title": "Game Request",
      "body": "Jeff wanna play with you",
      "action-loc-key": "PLAY"
    },
    "badge": 5
  }
}
```

### ì—°ë½ì²˜ ì •ë³´ ìˆ˜ì§‘ ì ˆì°¨

ì‚¬ìš©ì ë‹¨ë§ì´ êµ¬ë…(subscribe) ìš”ì²­ì„ ë³´ë‚´ë©´ user ì •ë³´(email)ì™€ device ì •ë³´(token)ê°€ DBì— ì €ì¥ëœë‹¤.

## ê°œëµì  ì„¤ê³„ì•ˆ

![notification_system.svg](images/notification_type.png)

- **ì´ë²¤íŠ¸ ì„œë¹„ìŠ¤** : ì™¸ë¶€ì—ì„œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì´ê¸° ë•Œë¬¸ì— ê´€ì‹¬ì—†ë‹¤.
- **ì•Œë¦¼ ì„œë²„** : ì•Œë¦¼ ì„œë²„ë¥¼ ì ì ˆí•œ íë¡œ ë³´ë‚¸ë‹¤. ë¡œê¹…ë„ í•œë‹¤.
- **Queue** : Adapterì™€ ì•Œë¦¼ ì„œë²„ ì‚¬ì´ì˜ ë²„í¼ ì—­í• , Adapter ë³„ë¡œ í•˜ë‚˜ì”© ìˆë‹¤.
- **Adapter** : ê° ì„œë“œ íŒŒí‹° ì•Œë¦¼ ì„œë¹„ìŠ¤ë³„ë¡œ í˜•ì‹ì„ ë§ì¶˜ë‹¤.
- **ì œ 3ì ì„œë¹„ìŠ¤** : ì•Œë¦¼ì„ ì‹¤ì œë¡œ ì „ë‹¬í•˜ëŠ” ì„œë¹„ìŠ¤, í™•ì¥ì„± ìˆê²Œ ì„¤ê³„í•´ì•¼ í•œë‹¤.

### íŠ¹ì§•

- ì•Œë¦¼ ì„œë²„ë¥¼ ìˆ˜í‰ í™•ì¥ì„± ìˆê²Œ êµ¬ì„±í•´ì„œ SPOF ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ìºì‹œë¥¼ í†µí•´ stateless ìœ ì§€
- Queueë¥¼ í†µí•´ ì•Œë¦¼ ì„œë²„ì™€ Adapter ì‚¬ì´ì˜ ê²°í•©ì„ ëŠê³  ì„œë¡œ í™•ì¥ì„± ìˆê²Œ êµ¬í˜„

### ì•Œë¦¼ ì„œë²„ì˜ ê¸°ëŠ¥

- ì¸ì¦(Authentication) : ì¸ì¦ëœ í´ë¼ì´ì–¸íŠ¸ê°€ ì•Œë¦¼ì„ ìƒì„±í•œë‹¤.
- ê²€ì¦(Validation) : ì´ë©”ì¼, ì „í™”ë²ˆí˜¸ ë“±ì— ëŒ€í•œ ê²€ì¦ì„ ì§„í–‰í•œë‹¤.

## ìƒì„¸ ì„¤ê³„

### ì•ˆì •ì„±

- ë°ì´í„° ì†ì„¤ ë°©ì§€ : ë¡œê·¸ë¥¼ ë‚¨ê¸°ê³  ì‹¤íŒ¨ê°€ ë‚  ê²½ìš° ì¬ì‹œë„ í•œë‹¤.
- ì¤‘ë³µ ì „ì†¡ ë°©ì§€ : ì´ë²¤íŠ¸ IDë¥¼ ê²€ì‚¬í•´ì„œ ì¤‘ë³µì„ ìµœëŒ€í•œ ì—†ì•¤ë‹¤. 100%ëŠ” ë¶ˆê°€ëŠ¥
  > **Itâ€™s usually causal ordering that weâ€™re after anyway. People who say otherwise donâ€™t quite realize thatÂ *[there is no now](https://queue.acm.org/detail.cfm?id=2745385)Â in a distributed system*.**

### ì¶”ê°€ ì»´í¬ë„ŒíŠ¸

- **ì•Œë¦¼ í…œí”Œë¦¿** : ë³€ìˆ˜ë¥¼ ì£¼ì… ê°€ëŠ¥í•œ í…œí”Œë¦¿ì„ ë§Œë“¤ì–´ì„œ ì“´ë‹¤. ì£¼ë¡œ `.tpl`ì¼ë ¤ë‚˜?
- **ì•Œë¦¼ ì„¤ì •** : ì•Œë¦¼ ìƒì„¸ ì„¤ì • ê¸°ëŠ¥ì„ ë„ì…í•˜ê³  ì•Œë¦¼ì„ ë³´ë‚´ê¸° ì „ ê²€ì‚¬í•œë‹¤.
- **ì „ì†¡ë¥  ì œí•œ**
- **ì¬ì‹œë„ ë°©ë²•** : ì•Œë¦¼ ì „ì†¡ì— ì‹¤íŒ¨í•˜ë©´ ì¬ì‹œë„ ì „ìš© íì— ë„£ê³ , ê°œë°œìì—ê²Œ ì•Œë¦¼
- **í‘¸ì‹œ ì•Œë¦¼ê³¼ ë³´ì•ˆ** : ì¸ì¦ëœ í´ë¼ì´ì–¸íŠ¸ë§Œ ì•Œë¦¼ì„ ìƒì„±í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. STS ì“°ë©´ ë˜ë‚˜?
- **í ëª¨ë‹ˆí„°ë§** : íì— ìŒ“ì¸ ì•Œë¦¼ ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ scalingí•œë‹¤.
- **ì´ë²¤íŠ¸ ì¶”ì ** : ëˆ ë˜ëŠ” ì§€í‘œë¥¼ ë½‘ëŠ”ë‹¤. (í´ë¦­ìœ¨, í™•ì¸ìœ¨ ë“±)

## ìˆ˜ì •ëœ ì„¤ê³„ì•ˆ

ğŸ’¡ ì•„ë˜ ë‘ ê·¸ë¦¼ ì¤‘ ì–´ëŠ ê²ƒì´ ë” ë‚˜ì€ê°€â€¦

![[https://cloudificationzone.com/2021/08/13/notification-system-design/](https://cloudificationzone.com/2021/08/13/notification-system-design/)](images/system1.png)

[https://cloudificationzone.com/2021/08/13/notification-system-design/](https://cloudificationzone.com/2021/08/13/notification-system-design/)

![[https://leandrofranchi.medium.com/how-to-design-a-notification-system-23f381cdeb00](https://leandrofranchi.medium.com/how-to-design-a-notification-system-23f381cdeb00)](images/system2.png)

[https://leandrofranchi.medium.com/how-to-design-a-notification-system-23f381cdeb00](https://leandrofranchi.medium.com/how-to-design-a-notification-system-23f381cdeb00)