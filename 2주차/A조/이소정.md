# 2장 개략적인 규모 추정

개략적인 규모 추정을 잘해내려면 규모 확장성을 표현해내는 데에 능해야 하는데, 이를 위해 2의 제곱수나 응답지연 (latency) 값, 가용성에 관계된 수치들을 기본적으로 알고 있어야 한다.

- **2의 제곱수**
    - 최소 단위는 1 바이트이고, 8 비트로 구성
    - ASCII 문자 하나가 차지하는 메모리 크기가 1 바이트
    - 2의 제곱 단위의 근사치에 따라 데이터 볼륨 단위를 표기 ( 킬로, 메가, 테라… )
- **모든 프로그래머가 알아야 하는** **응답지연 값**
    - 메모리는 빠르지만 디스크는 아직도 느리다
    - 디스크 탐색 (seek) 은 가능한 한 피하라 (약 20,000,000ns 즉 2ms 소요)
    - 단순한 압축 알고리즘은 빠르다
    - 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
    - 데이터 센터는 보통 여러 지역에 분산되어 있고, 센터들 간에 데이터를 주고받는 데에 시간이 걸린다
- **가용성에 관계된 수치들**
    - 고가용성 (high availability)
        - 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력.
        - 퍼센트로 표시. 대부분의 서비스는 99 - 100% 사이의 값을 가짐.
    - SLA (Service Level Agreement)
        - 서비스 사업자 (service provider) 와 고객 사이에 맺어진 합의
        - 서비스 사업자가 제공하는 가용시간 (uptime)이 공식적으로 기술됨. (아마존, 마이크로소프트, 구글은 99% 이상의 SLA 제공)
- **예제 : 트위터 QPS와 저장소 요구량 추정**
    - 가정
        - 월간 능동 사용자는 3억명
        - 50% 사용자가 트위터를 매일 사용
        - 평균적으로 각 사용자는 매일 2건의 트윗 올림
        - 미디어를 포함하는 트윗 10%
        - 데이터는 5년간 보관
    - QPS (Query Per Second) 추정치
        - 일간 능동 사용자 = 3억 X 50% = 1.5억
        - QPS = 1.5억 X 2트윗 / 24시간 / 3600초 = 약 3500
        - 최대 QPS (Peek QPS) = 2 X QPS = 약 7000
    - 미디어 저장을 위한 저장소 요구량
        - 평균 트윗 크기
            - tweet_id에 64바이트
            - 텍스트에 140바이트
            - 미디어에 1MB
        - 미디어 저장소 요구량 : 1.5억 X 2 X 10% X 1MB = 30TB
        - 5년간 미디어를 보관하기 위한 저장소 요구량 : 30TB X 365 X 5 = 약 55PB
- **TIP !!**
    - 근사치를 활용한 계산
        - 계산 결과의 정확함을 평가하지 않으므로 복잡한 계산에 시간쓰지 말고 10의 단위 수로 간소화하자. 예를 들을 99987/9.1은 100,000/10으로.
        - 가정은 적어두어라.
        - 단위를 붙여라. 스스로 헷갈리거나 모호한 상황을 방지하자.
        - QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 추정하는 문제가 자주 출제된다. 미리 연습하자.